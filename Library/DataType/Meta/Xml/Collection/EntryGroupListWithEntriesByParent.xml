<?xml version="1.0" encoding="UTF-8"?>

<type name="EntryGroupListWithEntriesByParent">
    <dataSource>
        <method>EntryGroupListWithEntriesByParent</method>

        <params>
            <entry_group_kind>block</entry_group_kind>
            <order>entry_group_parent.sort DESC</order>
        </params>

        <columns>
            <entry_group.id type="int" />
            <entry_group.kind type="varhcar" />
            <entry_group.title type="varhcar" />
            <entry_group.name type="varhcar" />
            <entry_group.description type="varhcar" />
            <entry_group.publish_date type="timestamp" />

            <entry_group_parent.id type="int" alias="parent_id" />
            <entry_group_parent.kind type="varhcar" alias="parent_kind" />
            <entry_group_parent.title type="varhcar" alias="parent_title" />
            <entry_group_parent.name type="varhcar" alias="parent_name" />
            <entry_group_parent.description type="varhcar" alias="parent_description" />
            <entry_group_parent.publish_date type="timestamp" alias="parent_publish_date" />
        </columns>
    </dataSource>

    <children>
        <entry method="EntryListByGroup" appendMethod="appendEntry" parent="id" child="group_id">
            <paramsFromParent>
                <region_id />
                <child-limit alias="limit" />
            </paramsFromParent>

            <fetch>
                <key>group_id</key>
                <key>id</key>
                <class>\Domain\Entity\Entry</class>
                <factory>\Domain\Entity\Entry::factory</factory>
            </fetch>

            <resources method="ResourceByEntry" parent="id" child="entry_id">
                <entry_list_anons count="1" />
                <entry_main_anons count="1" />
            </resources>
        </entry>
    </children>
</type>